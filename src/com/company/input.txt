CREATE TABLE movies (name VARCHAR(20), genre VARCHAR(8), year INTEGER) PRIMARY KEY (name);

INSERT INTO movies VALUES FROM ("Spiderman", "Action", 2002);
INSERT INTO movies VALUES FROM ("Batman", "Action", 2008);
INSERT INTO movies VALUES FROM ("Superman", "Comedy" 2004);
INSERT INTO movies VALUES FROM ("Joker", "Horror", 2019);

SHOW movies;

action_movies <- select (genre == Action) movies;
old_action_movies <- select (year < 2000) action_movies;

action_or_comedy <- action_movies + (select (genre == "Comedy") movies);

CREATE TABLE people (name VARCHAR(10), age INTEGER) PRIMARY KEY (name);

INSERT INTO people VALUES FROM RELATION project (name) movies;

a <- rename (aname, akind) (project (name, kind) animals);
common_names <- project (name) (select (aname == name && akind != kind) (a * animals));
answer <- common_names;

SHOW answer;

WRITE animals;
CLOSE animals;

EXIT;
